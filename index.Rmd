---
title: "Vulfpeck"
author: "Levi Knigge"
date: "10-2-2021"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
    theme: flatly
    css: styles.css
    orientation: rows
    toc: true
    toc_depth: 2
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, include=FALSE}
library(tidyverse)
library(spotifyr)
library(gridExtra)
library(flexdashboard)
library(readr)
library(leaflet)
library(DT)
library(lubridate)
library(plotly)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)
library(compmus)

```

Introduction
=========================================================================

```{r, echo=FALSE}
# Define variable containing url
url <- "https://media.ticketmaster.com/tm/en-us/dam/a/b1f/f8c61ced-7670-4495-8a8f-15b66cf9db1f_247161_CUSTOM.jpg"
```
<center><img src="`r url`"></center>

::: {.center data-latex=""}
This portfolio explores the albums and singles of Vulfpeck and their members and closely associated acts Theo Katzmann and Woody Goss and collaborative acts Joey Dosik and Cory Wong. Vulfpeck’s Joe Dart is praised as one of the best bassists to emerge in recent years, but that’s not the only reason for this choice. Firstly, Vulfpeck is known for their one-take style of recording and off-beat musical style. Secondly, the band has a few closely associated members that appear on a large section of their music. Finally, the band’s members have their own solo projects which often still feature each other. This allows us to compare the albums of these artists and see what makes their music unique.


The natural groups are the main artist on each album. Though they share a band there are some clear differences in genre, Vulfpeck is primarily funk, Theo Katzman is more slow love songs, Cory Wong has the danceability of pop music.


The albums and singles are a good representation of the artists. They all use Spotify as their primary way of distribution and have at least an album each.


Typical tracks for Vulfpeck are Cory Wong (yes that song is named after another artist in the list, it’s going to be confusing data!) or It Gets Funkier, the latter having the typical funk structure and interaction between instruments. An atypical song would be Theo Katzman’s As the Romans do. Whereas his solo music often has a halftime feel soulful style, this is an up-tempo track, more like what I would personally expect to come from Cory Wong’s repertoire. 


It will be interesting to find out what makes each artists music truly theirs, even though they are so closely related and collaborative.
:::



Data Exploration
=========================================================================


```{r}
vulfpeck <- get_playlist_audio_features("", "3nI3zFZc0zNawgGGBvlLjd")
woody <- get_playlist_audio_features("", "1YNoeB7YRKmwXDwxL6kXHv")
corywong <- get_playlist_audio_features("", "6PTxkUtHVL2MVwBVw45HhC")
katzman <- get_playlist_audio_features("", "26kcyNqQKAN3fnuO8NCL4B")

# summary(vulfpeck)

artists <-
  bind_rows(
    vulfpeck %>% mutate(category = "Vulfpeck"),
    woody %>% mutate(category = "Woody"),
    corywong %>% mutate(category = "Cory Wong"),
    katzman %>% mutate(category = "Katzman")
  )
```



Column {.sidebar}
--------------------------------------------------------

### Distribution of Valence 

To start off, we load the playlists containing each artists albums into its own variable, and create a combined dataframe using category as the dividing variable between the different artists. Now we can begin making some exploratory plots.

The first thing I was eager to find out is to see how accurate my own interpretation of each artists music was. One feature I could see making a clear division between artists was valence. I expected Cory Wong's music to be high in valence, because of it's positive and high energy feeling, Vulfpecks valence to be hard to grasp, and the same for Woody Goss. Their music has a very fun experimental quality but is modest in the musical expression of this enjoyment, it's not over the top happy-clappy music. Theo Katzman's music is more romantic, I would expect this to be an average valence, as it contains both the ups and downs of love.

Column {}
---------------------------------------------------

### Valence by artistS

```{r}

test <- ggplot(artists, aes(valence, ..density.., color=category)) +
  geom_histogram(bins=20, alpha=0.5) +
  facet_wrap(~ category) +
  theme(axis.text.y = element_blank())
test
```

> To my surprise, Cory Wong was shown to be the most 'negative' out of all four artists. 

### Tempo vs Dancability {data-padding=100}

```{r}
advanced <- artists %>%                    # Start with awards.
  mutate(
    mode = ifelse(mode == 0, "Minor", "Major")
  ) %>%
  ggplot(                     # Set up the plot.
    aes(
      x = tempo,
      y = danceability,
#      size = liveness,
      colour = mode
    )
  ) +
  geom_point(alpha = 0.5) +
  facet_wrap(~category) +
  scale_colour_brewer(        # Use the Color Brewer to choose a palette.
    type = "qual",            # Qualitative set.
    palette = "Set1"        # Name of the palette is 'Paired'.
  ) +             # Use a simpler theme.
  labs(                       # Make the titles nice.
    x = "Tempo",
    y = "Danceability",
    colour = "Mode"
  )
advanced
```

***

To see where this difference is coming from I looked at some more low-level features such as tempo and mode. This plot gives a good interpretation of some of the differences between the artists.



It Gets Funkier {.storyboard}
=================================================

### It Gets Funkier
```{r}

fig <- function(width, heigth){
     options(repr.plot.width = width, repr.plot.height = heigth)
}
funky1 <-
  get_tidy_audio_analysis("0vOAN45nUNSqRIWPTOSDsJ") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

funky2 <-
  get_tidy_audio_analysis("33BRNcBN01BsjKkAxlFYI4") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

funky3 <-
  get_tidy_audio_analysis("7IMHomgWWQAxCueJX8DKFi") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

funky4 <-
  get_tidy_audio_analysis("2eNKE4PW5uL0pIfGNw01SV") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)

funky1 %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  xlim(12, 30)

```

***

Description


### It Gets Funkier II

```{r}
fig(10,4)
funky2 %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  xlim(9, 30)




```


### It Gets Funkier III


```{r}
funky3 %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  xlim(11, 30)

```


### It Gets Funkier IV


```{r}
funky4 %>%
  mutate(pitches = map(pitches, compmus_normalise, "euclidean")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude") +
  theme_minimal() +
  scale_fill_viridis_c() +
  xlim(10, 15)

```

### Frame 5

```{r}
tl <- compmus_long_distance(
  funky1 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  funky2 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  feature = pitches,
  method = "manhattan"
) %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "I", y = "II") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

tr <- compmus_long_distance(
  funky1 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  funky3 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  feature = pitches,
  method = "manhattan"
) %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "I", y = "III") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

bl <- compmus_long_distance(
  funky2 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  funky3 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  feature = pitches,
  method = "manhattan"
) %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "II", y = "III") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

br <- compmus_long_distance(
  funky3 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  funky4 %>% mutate(pitches = map(pitches, compmus_normalise, "manhattan")),
  feature = pitches,
  method = "manhattan"
) %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_equal() +
  labs(x = "III", y = "IV") +
  theme_minimal() +
  scale_fill_viridis_c(guide = NULL)

grid.arrange(tl, tr, bl, br, ncol=2)


```
*** 
  
Description

Here we compare the different versions of It Gets Funkier.

Despite their seeming similarity, I could not get the dynamic time-warping to show that result clearly.
